<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MetadynamicsBias &#8212; OpenXPS dev  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=572d9513" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=ccdb6887"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ExtendedSpaceSimulation" href="ExtendedSpaceSimulation.html" />
    <link rel="prev" title="SplitIntegrator" href="SplitIntegrator.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="metadynamicsbias">
<h1>MetadynamicsBias<a class="headerlink" href="#metadynamicsbias" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="openxps.MetadynamicsBias">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">openxps.</span></span><span class="sig-name descname"><span class="pre">MetadynamicsBias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynamical_variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandwidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_sizes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openxps/metadynamics.html#MetadynamicsBias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openxps.MetadynamicsBias" title="Link to this definition">¶</a></dt>
<dd><p>A Metadynamics potential applied to dynamical variables.</p>
<div class="math notranslate nohighlight">
\[V({\bf x}) = \sum_{i=1}^{N} h_i \exp\left\{
    -\frac{1}{2} \left(
        {\bf x} - {\bf c}_i
    \right)^T [{\bf D}({\boldsymbol \sigma}_i)]^{-2} \left(
        {\bf x} - {\bf c}_i
    \right)
\right\}\]</div>
<p>where <span class="math notranslate nohighlight">\({\bf x}\)</span> is the vector of dynamical variables, <span class="math notranslate nohighlight">\(h_i\)</span> is
the height of the Gaussian kernel, <span class="math notranslate nohighlight">\({\bf c}_i\)</span> is the center of the kernel,
<span class="math notranslate nohighlight">\({\boldsymbol \sigma}_i\)</span> is the bandwidth vector of the kernel, and
<span class="math notranslate nohighlight">\({\bf D}(\cdot)\)</span> builds a diagonal matrix from a vector.</p>
<p>The bias potential can be interpolated on a grid using natural splines for 1D, 2D,
or 3D functions. This is done by providing the number of points in each dimension
of the grid. If the grid is not provided, the bias potential is evaluated directly
from the mathematical expression, which gets more expensive as the number of added
kernels increases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dynamical_variables</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="DynamicalVariable.html#openxps.DynamicalVariable" title="openxps.dynamical_variable.DynamicalVariable"><em>DynamicalVariable</em></a><em>]</em>) – The dynamical variables subject to the bias potential.</p></li>
<li><p><strong>bandwidth</strong> (<em>Sequence</em><em>[</em><em>Quantity</em><em>]</em>) – The bandwidth vector of the Gaussian kernel. Each element must have units of
the corresponding dynamical variable.</p></li>
<li><p><strong>initial_height</strong> (<em>Quantity</em>) – The initial height of the Gaussian kernels. It must have units of molar energy.</p></li>
<li><p><strong>temperature</strong> (<em>Quantity</em>) – The temperature of the system (with units).</p></li>
<li><p><strong>bias_factor</strong> (<em>float</em>) – The bias factor that controls the equilibrium bias potential and the rate of
convergence. It must be larger than 1.</p></li>
<li><p><strong>grid_sizes</strong> (<em>Sequence</em><em>[</em><em>int</em><em>] </em><em>| </em><em>None</em>) – The number of points in each dimension of the grid used to interpolate the bias
potential.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the bias factor is not larger than 1 or if temperature does not have valid
    units.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<dl class="py method">
<dt class="sig sig-object py" id="openxps.MetadynamicsBias.getBias">
<span class="sig-name descname"><span class="pre">getBias</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openxps/metadynamics.html#MetadynamicsBias.getBias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openxps.MetadynamicsBias.getBias" title="Link to this definition">¶</a></dt>
<dd><p>Get the bias values on a spline grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The bias values on the spline grid.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openxps.MetadynamicsBias.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context_dvs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openxps/metadynamics.html#MetadynamicsBias.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openxps.MetadynamicsBias.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the bias potential for a specific context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>context_dvs</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="DynamicalVariable.html#openxps.DynamicalVariable" title="openxps.dynamical_variable.DynamicalVariable"><em>DynamicalVariable</em></a><em>]</em>) – All the dynamical variables in the extension context.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">OpenXPS dev</a></h1>











<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="classes.html">Classes</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ExtendedSpaceContext.html">ExtendedSpaceContext</a></li>
<li class="toctree-l3"><a class="reference internal" href="DynamicalVariable.html">DynamicalVariable</a></li>
<li class="toctree-l3"><a class="reference internal" href="ExtensionWriter.html">ExtensionWriter</a></li>
<li class="toctree-l3"><a class="reference internal" href="LockstepIntegrator.html">LockstepIntegrator</a></li>
<li class="toctree-l3"><a class="reference internal" href="SplitIntegrator.html">SplitIntegrator</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">MetadynamicsBias</a></li>
<li class="toctree-l3"><a class="reference internal" href="ExtendedSpaceSimulation.html">ExtendedSpaceSimulation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">Bibliography</a></li>
</ul>

<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024 C. Abreu.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/api/MetadynamicsBias.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>